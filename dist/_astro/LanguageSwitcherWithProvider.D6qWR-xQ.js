import{j as t}from"./jsx-runtime.CDc-DwQj.js";import{R as x}from"./index.t7h89SRg.js";import{translations as u}from"./translations.ILKHutgA.js";const{createContext:h,useState:a,useContext:w,useEffect:g}=x,l=h(void 0),c="preferred-language",p=({children:n})=>{const[o,r]=a("en"),[s,i]=a(!1),[E,d]=a(!0);g(()=>{i(!0);try{if(typeof window<"u"&&typeof window.getCurrentLanguage=="function"){const e=window.getCurrentLanguage();r(e)}else{const e=localStorage.getItem(c);if(e&&(e==="en"||e==="zh"))r(e);else{const m=navigator.language.split("-")[0];r(m==="zh"?"zh":"en")}}}catch(e){console.error("Error initializing language:",e)}finally{d(!1)}},[]);const f={language:o,setLanguage:e=>{r(e),s&&(localStorage.setItem(c,e),document.dispatchEvent(new CustomEvent("languageChanged",{detail:{language:e}})),window.dispatchEvent(new StorageEvent("storage",{key:c,newValue:e,storageArea:localStorage})))},t:e=>typeof window<"u"&&typeof window.translateSync=="function"?window.translateSync(e,o):u[e]?u[e][o]||u[e].en||e:(console.warn(`Translation key not found: ${e}`),e)};return t.jsx(l.Provider,{value:f,children:n})},L=()=>{const n=w(l);if(n===void 0)throw new Error("useLanguage must be used within a LanguageProvider");return n},v=({className:n=""})=>{const{language:o,setLanguage:r}=L(),[s,i]=a(!1);return g(()=>{i(!0)},[]),s?t.jsxs("div",{className:`${n} inline-flex items-center`,children:[t.jsx("button",{onClick:()=>r("en"),className:`text-sm transition-colors ${o==="en"?"text-primary font-medium":"text-muted-foreground hover:text-foreground"}`,"aria-label":"Switch to English",children:"EN"}),t.jsx("span",{className:"mx-1 text-muted-foreground",children:"/"}),t.jsx("button",{onClick:()=>r("zh"),className:`text-sm transition-colors ${o==="zh"?"text-primary font-medium":"text-muted-foreground hover:text-foreground"}`,"aria-label":"切换到中文",children:"中"})]}):t.jsxs("div",{className:`${n} inline-flex items-center`,children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"EN"}),t.jsx("span",{className:"mx-1 text-muted-foreground",children:"/"}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"中"})]})},y=({className:n="flex items-center"})=>t.jsx(p,{children:t.jsx(v,{className:n})});export{y as LanguageSwitcherWithProvider};
